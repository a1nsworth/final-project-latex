% --- Кодировка и локализация ------------------------------------
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}

\usepackage{eskdchngsheet}
\usepackage{ulem} 
\usepackage{acronym}
% 1) Загружаем minted как float-пакет
\usepackage[float]{minted}

\usepackage[square,numbers,sort&compress]{natbib}

% 4) Меняем формат номера: <номер секции>.<номер листинга>
\renewcommand{\thelisting}{\thesection.\arabic{listing}}


\usepackage{xcolor}
\definecolor{codebg}{RGB}{245,247,250}

\usepackage{minted}
\setminted{%
  style=xcode,            % мягкая, контрастная подсветка
  bgcolor=codebg,         % фон блока
  frame=single,           % тонкая рамка вокруг
  framerule=0.5pt,        % толщина рамки
  framesep=2mm,           % отступ текста от рамки
  rulecolor=\color{gray!60}, % цвет рамки
  linenos,                % нумерация строк
  numbersep=5pt,          % расстояние номера от кода
  xleftmargin=2em,        % дополнительный отступ слева
  autogobble,             % обрезаем общий отступ кода
  fontsize=\footnotesize, % компактный шрифт
  baselinestretch=1,      % одинарный межстрочный
  breaklines,             % автоматически переносить длинные строки
  breakindent=1em,        % отступ для перенесённых строк
  tabsize=2               % табуляция = 2 пробела
}
% -------------------------------------------------

\usepackage{lastpage}
\usepackage{newtxmath}

% \usepackage{pscyr}
% \renewcommand{\rmdefault}{ftm}

%--- Математика --------------------------------------------------
\usepackage{amsmath, amsfonts, amsthm}
% \usepackage{mathtools}               % расширения для amsmath

\DeclareMathOperator{\CP}{CP}

%--- Графика и рисунки ------------------------------------------
\usepackage{caption}
\usepackage{float}
\usepackage{graphicx}                % вставка растровых и векторных изображений
\usepackage{tikz}                    % рисование диаграмм, схем и т.п.
\usetikzlibrary{
  positioning,
  shapes,
  arrows.meta,
  fit,
  matrix,
  calc
}
\usepackage{pgfplots}                % построение графиков
\pgfplotsset{compat=1.17}

\usetikzlibrary{patterns,intersections,fillbetween}
\usepgfplotslibrary{fillbetween}

%--- Таблицы ----------------------------------------------------
\usepackage{longtable}               % большие таблицы
\usepackage{tabularx}                % табличный текст с автоподбором ширины
\usepackage{booktabs}                % красивые горизонтальные линии

%--- Счётчики ---------------------------------------------------
\usepackage{chngcntr}
\counterwithin{figure}{section}       % нумерация рисунков по секциям
\counterwithin{table}{section}        % нумерация таблиц по секциям
\counterwithin{equation}{section}

%--- Оформление заголовков --------------------------------------
\usepackage{titlesec}

% \titleclass{\subsubsubsection}{straight}[\subsubsection]
% \newcounter{subsubsubsection}[subsubsection]
% \renewcommand\thesubsubsubsection%
%   {\thesubsubsection.\arabic{subsubsubsection}}

\titleformat{\paragraph}[block]
  {\normalfont\normalsize\bfseries} % ваш стиль
  {\theparagraph}{1em}{}             % номер + отступ
\titleformat{\subparagraph}[block]
  {\normalfont\normalsize\bfseries}
  {\thesubparagraph}{1em}{}
  
\titlespacing*{\section}
{0pt}{7ex}{3ex}
\titlespacing*{\subsection}
{0pt}{5ex}{1.5ex}
\titlespacing*{\subsubsection}
{0pt}{5ex}{1.5ex}
\titlespacing*{\paragraph}
{0pt}{1ex}{0.5ex}
\titlespacing*{\subparagraph}
{0pt}{1ex}{0.5ex}

%--- Междустрочный интервал -------------------------------------
\usepackage{setspace}
\onehalfspacing                      % полуторный интервал

%--- Работа с исходным кодом -----------------------------------
\usepackage{listings}
\usepackage{xcolor}
% Цветовые определения для listings
\definecolor{codebg}{HTML}{F8F8F8}
\definecolor{keyword}{RGB}{0,0,180}
\definecolor{string}{RGB}{163,21,21}
\definecolor{comment}{RGB}{0,128,0}
\definecolor{builtin}{RGB}{43,145,175}
\definecolor{type}{RGB}{127,0,85}
\definecolor{number}{RGB}{128,0,128}


%--- Гиперссылки -----------------------------------------------
\usepackage{hyperref}

\theoremstyle{definition}
\newtheorem{definition}{Определение}[section]

\theoremstyle{plain}
\newtheorem{theorem}{Теорема}[section]
\newtheorem{lemma}[theorem]{Лемма}

\theoremstyle{remark}
\newtheorem*{remark}{Замечание}

\newtheorem{example}{Пример}[section]

\usepackage{natbib}

\usepackage{enumitem}

\makeatletter
\AddEnumerateCounter{\asbuk}{\russian@alph}{щ}
\makeatother

% ------------------------------------------------
% Универсальные отступы для всех списков, измеряемые в \parindent
\setlist{%
  leftmargin=0.8\parindent,                 % отступ всего списка = \parindent
  labelsep=0.5em,                % расстояние между меткой и текстом = 0.5·\parindent itemsep=0.5em,                           % вертикальный пробел между пунктами
  parsep=0pt,                            % отступ между абзацами внутри пункта
  topsep=0.1\parindent,                  % отступ перед первым и после последнего пункта = 0.5·\parindent
  partopsep=0pt                          % дополнительный отступ при разрыве абзаца перед списком
}

% ------------------------------------------------
% теперь — глобально для первого уровня enumerate
\setlist[enumerate,1]{%
  label=\asbuk*),     % метка: а), б), в)…
  ref=\asbuk*),       % чтобы \ref тоже работал
}

\setlength{\floatsep}{1.5\baselineskip}    % между двумя плавающими объектами
\setlength{\textfloatsep}{1.5\baselineskip}% между плавающим объектом и текстом
\setlength{\intextsep}{1.5\baselineskip}   % для плавающих объектов внутри текста

% 2. Одинарный (или иной) интервал внутри caption
\usepackage{caption}
\captionsetup{
  font={stretch=1.5},  % small + ровно одинарный межстрочный (stretch=1)
  skip=0.5\baselineskip    % небольшой вертикальный отступ «caption–текст»
}


\captionsetup[listing]{name=Листинг}
